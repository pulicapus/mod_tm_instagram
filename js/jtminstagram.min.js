/*
 * jTMInstagram
 * Created by: TemplateMonster - http://templatemonster.com
 * Version: 1.0.0
 * Copyright (C) 2012 - 2013 Jetimpex, Inc.
 * License: http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2
*/
 
;(function ($) {
    $.fn.jtminstagram = function (options) {

        // Defaults
        var defaults = {
            user_name: null,
            client_id: null,
            count: 10
        };                      

        var o = $.extend(defaults, options);

        return this.each(function () {
        
          // Vars
          var elem = $(this),
              url = "https://api.instagram.com/v1/users/search?q="+o.user_name+"&client_id="+o.client_id + "&callback=?";

              $.getJSON(url, function(data){
                o.user_id = data.data[0].id

              url = "https://api.instagram.com/v1/users/" + o.user_id + "/media/recent?client_id=" + o.client_id + "&count=" + o.count + "&callback=?";

            // Get the images	
            $.getJSON(url, function(data){
                $.each(data.data, function (i, val) {
                    var li = $("<li/>").appendTo(elem),
                        a = $("<a/>", {"href": val.link, "target": "_blank"}).appendTo(li),
                        img = $("<img/>", {"src" : val.images.thumbnail.url, "alt" : val.caption.text}).appendTo(a);
                    
                    if (val.caption){
                        a.attr("title", val.caption.text);
                    }
                });
            });
                
              });

        });
    };
})(jQuery);